# 2.3.安装前的准备工作

### 准备安装媒体

FreeBSD 安装程序不是可以在另一个操作系统中运行的应用程序。相反，需要下载 FreeBSD 安装文件，将其刻录到与其文件类型和大小相关联的媒体（CD、DVD 或 USB），然后引导系统以从插入的媒体安装。

FreeBSD 安装文件可在[FreeBSD 下载页面](https://www.freebsd.org/where/)获得。每个安装文件的名称包含 FreeBSD 的发行版本、架构和文件类型。

安装文件以多种格式提供，使用[xz(1)](https://man.freebsd.org/cgi/man.cgi?query=xz&sektion=1&format=html)进行压缩或不压缩。格式取决于计算机架构和介质类型。

安装文件类型：

- **`-bootonly.iso`**：这是最小的安装文件，因为它只包含安装程序。在安装过程中需要一个可用的互联网连接，因为安装程序将下载完成 FreeBSD 安装所需的文件。此文件应刻录到光盘介质。
- **`-disc1.iso`**：此文件包含安装 FreeBSD 所需的所有文件，以及其源代码和 Ports 集合。此文件应刻录到光盘介质。
- **`-dvd1.iso`**：此文件包含安装 FreeBSD 所需的所有文件，以及其源代码和 Ports 集合。它还包含用于安装窗口管理器和一些应用程序的一组流行的二进制包，以便可以从介质上安装完整的系统，而无需连接到互联网。此文件应刻录到光盘介质。
- **`-memstick.img`**：此文件包含安装 FreeBSD 所需的所有文件，以及其源代码和 Ports 集合。将此文件写入 USB 闪存驱动器，如[写入镜像文件到 USB](https://docs.freebsd.org/en/books/handbook/book/#bsdinstall-usb)中所示。
- **`-mini-memstick.img`**：类似于 `<strong>-bootonly.iso</strong>`，不包含安装文件，但根据需要进行下载。在安装过程中需要一个可用的互联网连接。应按照[写入镜像文件到 USB](https://docs.freebsd.org/en/books/handbook/book/#bsdinstall-usb)中的说明将其写入 USB 闪存驱动器。

下载镜像文件后，请至少从相同目录下载一个*checksum*文件。有两个*checksum*文件，按照发行版本号和架构名称命名。例如：`CHECKSUM.SHA256-FreeBSD-13.1-RELEASE-amd64`和`CHECKSUM.SHA512-FreeBSD-13.1-RELEASE-amd64`。

下载其中一个文件（或两个文件）后，计算镜像文件的*checksum*，并将其与*checksum*文件中显示的进行比较。请注意，您需要将计算得到的*checksum*与正确的文件进行比较，因为它们对应于两种不同的算法：SHA256 和 SHA512。FreeBSD 提供了[sha256(1)](https://man.freebsd.org/cgi/man.cgi?query=sha256&sektion=1&format=html)和[sha512(1)](https://man.freebsd.org/cgi/man.cgi?query=sha512&sektion=1&format=html)可用于计算*checksum*的工具。其他操作系统也有类似的程序。

在 FreeBSD 中使用[sha256sum(1)](https://man.freebsd.org/cgi/man.cgi?query=sha256sum&sektion=1&format=html)（以及[sha512sum(1)](https://man.freebsd.org/cgi/man.cgi?query=sha512sum&sektion=1&format=html)）可以自动验证*checksum*，执行以下操作：

```sh
% sha256sum -c CHECKSUM.SHA256-FreeBSD-13.1-RELEASE-amd64 FreeBSD-13.1-RELEASE-amd64-dvd1.iso
FreeBSD-13.1-RELEASE-amd64-dvd1.iso: OK
```

*checksum*必须完全匹配。如果*checksum*不匹配，则镜像文件已损坏，必须重新下载。

#### 2.3.1.1. 将镜像文件写入 USB

`*memstick.img`文件是存储卡的完整内容的*image*。不能将其作为文件复制到目标设备。有几个应用程序可用于将`*.img`写入 USB 存储卡。本节描述了其中两个实用工具。

|     | 在进行操作之前，请备份 USB 存储卡上的任何重要数据。此过程将擦除存储卡上的现有数据。 |
| --- | ----------------------------------------------------------------------------------- |

**步骤。使用 `dd`​ 来写入镜像**

|     | 此示例将`/dev/da0`用作将写入镜像的目标设备。请非常小心，确保使用正确的设备，因为此命令将破坏指定目标设备上的现有数据。 |
| --- | ---------------------------------------------------------------------------------------------------------------------- |

1. 此命令行实用程序在 BSD、Linux® 和 Mac OS® 系统上都可用。要使用`dd`刻录镜像，请插入 USB 存储卡并确定其设备名称。然后，指定已下载安装文件的名称和 USB 存储卡的设备名称。此示例将 amd64 安装镜像刻录到现有 FreeBSD 系统上的第一个 USB 设备。

   ```sh
   # dd if=FreeBSD-13.1-RELEASE-amd64-memstick.img of=/dev/da0 bs=1M conv=sync
   ```

   如果此命令失败，请验证 USB 存储卡未被挂载，并且设备名称用于磁盘，而不是分区。

   一些操作系统可能要求使用[sudo(8)](https://man.freebsd.org/cgi/man.cgi?query=sudo&sektion=8

&format=html)运行此命令。[dd(1)](https://man.freebsd.org/cgi/man.cgi?query=dd&sektion=1&format=html)在不同平台上的语法略有不同；例如，Mac OS® 需要小写的`bs=1m`。像 Linux® 之类的系统可能会缓冲写入。为了强制所有写入完成，请使用[sync(8)](https://man.freebsd.org/cgi/man.cgi?query=sync&sektion=8&format=html)。

**步骤。使用 Windows® 来写入镜像**

|     | 请务必提供正确的驱动器字母，因为指定驱动器上的现有数据将被覆盖和销毁。 |
| --- | ---------------------------------------------------------------------- |

1. **获取 Windows® 的 Image Writer**
   Image Writer for Windows® 是一个免费应用程序，可以正确地将镜像文件写入存储卡。从[win32diskimager 主页](https://sourceforge.net/projects/win32diskimager/)下载并将其解压缩到文件夹中。
2. **使用 Image Writer 写入镜像**
   双击 Win32DiskImager 图标启动程序。确保`Device`下显示的驱动器字母是带有存储卡的驱动器。单击文件夹图标，然后选择要写入存储卡的镜像。单击**Save**以接受镜像文件名。验证一切都正确，存储卡上没有窗口中的文件夹是打开的。当一切准备就绪时，单击**Write**将镜像文件写入存储卡。
